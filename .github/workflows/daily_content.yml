
name: Gerador de Conteúdo Diário - Andrezza Mota

on:
  schedule:
    # Roda todos os dias às 09:00 AM (Horário de Brasília aprox. 12:00 UTC)
    - cron: '0 12 * * *'
  workflow_dispatch: # Permite rodar manualmente

jobs:
  build-and-publish:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write # Permissão para salvar o arquivo no repositório
      
    steps:
      - name: Baixar código do repositório
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Instalar dependências da IA
        run: |
          pip install google-generativeai

      - name: Rodar o Gerador de Conteúdo
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: python scripts/gerador_conteudo.py

      - name: Salvar e Publicar (Commit & Push)
        run: |
          git config --global user.name 'Bot Andrezza IA'
          git config --global user.email 'bot@espacoandrezzamota.com.br'
          git add content/posts/*.md
          # Só faz commit se houver mudança
          git commit -m "Novo post gerado via IA: $(date +'%Y-%m-%d')" || exit 0
          git push
